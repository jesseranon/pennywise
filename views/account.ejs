<%- include('partials/header') -%>
<% let accountTransactions = null %>
<% if (account.debits.length > 0 && account.credits.length > 0) { %>
  <% accountTransactions = account.debits.concat(account.credits) %>
  <% accountTransactions.sort((a, b) => a.date - b.date) %>
<% } %>
<div class="container">
  <div class="row justify-content-center mt-5">
    <div class="col-6">
      <h2><%= account.name %></h2>
      <p>Account Type: <%= account.type %></p>
      <p>Transactions</p>
      <% if (accountTransactions) { %>
        <ul>
          <% for (let i = 0; i < accountTransactions.length; i++) { %>
            <% let incDec = null %>
            <% const transaction = accountTransactions[i]%>
            <% let transactionFoundInDebits = account.debits.filter(t => t._id == transaction._id).length > 0 %>
            <% if (account.balanceType == 'asset') { %>
              <% if (transactionFoundInDebits) { %>
                <% incDec = "+" %>
              <% } else { %> 
                <% incDec = "-" %>
              <% } %>
            <% } else { %>
              <% if (transactionFoundIndebits) { %>
                <% incDec = "-" %>
              <% } else { %> 
                <% incDec = "+" %>
              <% } %>
            <% } %>
            <li>
              <span><%= transaction.date.toLocaleDateString('en-us') %></span>
              <span><%= transaction.category.name %></span>
              <span><%= incDec %> <%= user.currency %><%= transaction.amount %></span>
            </li>
          <% } %>
        </ul>
      <% } %>
    <div class="col-6 mt-5">
      <a class="btn btn-primary" href="/profile">Return to Profile</a>
    </div>
  </div>
</div>

<%- include('partials/footer') -%>
